<html>
  <head></head>
  <body>
    <?
      switch (projectStatus) {
        case 'On Track':
        case 'Delivered':
          statusColor = 'green';
          statusText = 'white';
          break;
        case 'Keep Watch':
          statusColor = 'yellow';
          statusText = 'black';
          break;
        case 'Blocked':
          statusColor = 'red';
          statusText = 'white';
          break;
        default:
          statusColor = 'gray';
          statusText = 'white'
      }
    ?>
    <table style="font-size: 14px; width:100%; border: 1px #000000 solid; border-collapse: collapse;">
      <tr style="background-color: #000000; height: 40px; color:#ffffff;">
        <td rowspan="2" style="padding-left: 20px; width: 30%;">
          <img style="max-height: 40px; width: auto;" src="<?= logoUrl ?>">
        </td>
        <td style="text-align: right; font-weight: bold; font-size: 18px; padding: 10px 20px 0px 0px; width:70%;">
          Project Status Update
        </td>
      </tr>
      <tr style="background-color: #000000; height: 40px; color:#ffffff;">
        <td style="text-align: right; font-size: 14px; padding: 0px 20px 10px 0px; width:70%;">
          <?= getDate() ?>
        </td>
      </tr>
      <tr style="height:10px; background-color:<?= statusColor ?>;">
        <td colspan="2"></td>
      </tr>
      <tr>
        <td colspan="2" style="font-size: 24px; font-weight: bold; padding: 10px; padding-top: 20px;">
          <?= projectName ?>
          <span style="font-size: 14px;">(<a href="<?= projectLink ?>">project page</a>)</span>
        </td>
      </tr>
      <tr>
        <td style="font-weight: bold; padding: 10px; vertical-align:top;">
          Project Status
        </td>
        <td style="padding: 10px; vertical-align:top;">
          <span style="border-radius: 25px; color: <?= statusText ?>; font-weight: bold; padding: 5px 20px 5px 20px; background-color:<?= statusColor ?>;">
            <?= projectStatus ?>
          </span>
        </td>
      </tr>
      <tr>
        <td style="font-weight: bold; padding: 10px; vertical-align:top;">
          Project Stage
        </td>
        <td style="padding: 10px; vertical-align:top;">
          <?= projectStage ?>
        </td>
      </tr>
      <? if (targetDate) {?>
        <tr>
          <td style="font-weight: bold; padding: 10px; vertical-align:top;">
            Target Launch Date
          </td>
          <td style="padding: 10px; vertical-align:top;">
            <?= targetDate ?>
          </td>
        </tr>
      <? } ?>
      <tr>
        <td style="font-weight: bold; padding: 10px; vertical-align:top;">
          Executive Summary
        </td>
        <td style="padding: 10px; vertical-align:top;">
          <?= execSummary ?>
        </td>
      </tr>
      <? if (projectStatus == 'Keep Watch' || projectStatus == 'Blocked' || projectStatus == 'On Hold') { ?>
        <tr>
          <td style="font-weight: bold; padding: 10px; vertical-align:top;">
            Path To Green
          </td>
          <td style="padding: 10px; vertical-align:top;">
            <ul style="margin:0; padding:0;">
              <? pathToGreen.forEach(function(bullet) {
                if (bullet != '') { ?>
                  <li><?= bullet ?></li>
                <? } ?>
              <? }); ?>
            </ul>
          </td>
        </tr>
      <? } ?>
      <tr>
        <td style="font-weight: bold; padding: 10px; vertical-align:top;">
          Recent Activity
        </td>
        <td style="padding: 10px; vertical-align:top;">
          <ul style="margin:0; padding:0;">
            <? recentActivity.forEach(function(bullet) {
                if (bullet != '') { ?>
                  <li><?= bullet ?></li>
                <? } ?>
              <? }); ?>
          </ul>
        </td>
      </tr>
      <tr>
        <td  style="font-weight: bold; padding: 10px; vertical-align:top;">
          Upcoming Milestones
        </td>
        <td style="padding: 10px; vertical-align:top;">
          <ul style="margin:0; padding:0;">
            <? upcomingMiles.forEach(function(bullet) {
                if (bullet != '') { ?>
                  <li><?= bullet ?></li>
                <? } ?>
              <? }); ?>
          </ul>
        </td>
      </tr>
      <? if (imageTitle) { ?>
        <tr>
          <td style="font-weight: bold; padding: 10px; vertical-align:top;">
            <?= imageTitle ?>
          </td>
          <td style="padding: 10px; vertical-align:top;">
            <img style="max-height: 300px; max-width: 100%;" src="cid:userimage">
          </td>
        </tr>
      <? } ?>
      <tr style="height:10px; background-color: <?= statusColor ?>;">
        <td colspan="2"></td>
      </tr>
      <tr>
        <td colspan="2" style="background-color: #f3f3f3; height: 50px; font-style: italic; font-size: 11px; padding: 10px; text-align: center;">
          <a style="color: #000000" href="<?= footerLink ?>"><?= footerText ?></a>
        </td>
      </tr>
    </table>
  </body>
</html>